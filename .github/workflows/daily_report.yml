name: ğŸŒŸ Daily GitHub Trending Report

on:
  schedule:
    # æ¯å¤© UTC æ—¶é—´ 0:00 è¿è¡Œï¼ˆå¯¹åº”åŒ—äº¬æ—¶é—´æ—©ä¸Š 8:00ï¼‰
    - cron: '0 0 * * *'
  # å…è®¸ä½ åœ¨ GitHub ç½‘é¡µä¸Šæ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®è¿è¡Œ
  workflow_dispatch:

permissions:
  contents: write # å…è®¸æœºå™¨äººæŠŠç”Ÿæˆçš„æ–‡ä»¶æ¨é€åˆ°ä½ çš„ä»“åº“

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: è®¾ç½® Node.js ç¯å¢ƒ
        uses: actions/setup-node@v4
        with:
          node-version: '18' # ä½¿ç”¨ç¨³å®šçš„ Node.js ç‰ˆæœ¬

      - name: å®‰è£…ä¾èµ–
        run: npm install

      - name: è¿è¡Œç”Ÿæˆè„šæœ¬
        # è¿™é‡Œä¼šè‡ªåŠ¨è¯»å–ä½ åœ¨ Github é…ç½®çš„ä¿é™©ç®±å¯†ç 
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          OPENAI_BASE_URL: https://api.deepseek.com
          OPENAI_MODEL: deepseek-chat
        run: npm start

      - name: æäº¤å¹¶æ¨é€åˆ°ä»“åº“
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add data/ reports/
          git commit -m "auto: ğŸŒŸ ç”Ÿæˆä»Šæ—¥ GitHub Trending ç®€æŠ¥" || echo "ä»Šå¤©æ²¡æœ‰æ–°æ•°æ®ï¼Œè·³è¿‡æäº¤"
          git push